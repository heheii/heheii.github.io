<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/5/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/5/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hexo</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/18/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/%E6%A0%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/18/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/%E6%A0%91/" class="post-title-link" itemprop="url">树</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-18 15:33:34" itemprop="dateCreated datePublished" datetime="2021-02-18T15:33:34+08:00">2021-02-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:26:41" itemprop="dateModified" datetime="2023-02-08T00:26:41+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">数据结构与算法</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-B-树"><a href="#1-B-树" class="headerlink" title="1 B+树"></a>1 B+树</h1><p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FsbDcldJKWL19S6S3Z5gQI2UnEg3.png"><br>B+Tree 由三部分组成：根 root、枝 branch 以及 Leaf 叶子，其中 root 和 branch 不存储数据，只存储指针地址，数据全部存储在 Leaf Node，同时 Leaf Node 之间用双向链表链接</p>
<p>从 root 到每个 Leaf 的距离是相等的，也就是访问任何一个 Leaf Node 需要的 IO 是一样的，即索引树的高度 Level + 1 次 IO 操作</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/17/java%E5%9F%BA%E7%A1%80/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/17/java%E5%9F%BA%E7%A1%80/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/" class="post-title-link" itemprop="url">动态代理</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-17 23:46:37" itemprop="dateCreated datePublished" datetime="2021-02-17T23:46:37+08:00">2021-02-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:45:24" itemprop="dateModified" datetime="2023-02-08T00:45:24+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">java基础</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-jdk-动态代理"><a href="#1-jdk-动态代理" class="headerlink" title="1 jdk 动态代理"></a>1 jdk 动态代理</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">作者：bravo1988</span><br><span class="line">链接：https:<span class="comment">//www.zhihu.com/question/20794107/answer/658139129</span></span><br><span class="line">来源：知乎</span><br><span class="line">著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyTest</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">		<span class="type">CalculatorImpl</span> <span class="variable">target</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CalculatorImpl</span>();</span><br><span class="line">		<span class="type">Calculator</span> <span class="variable">calculatorProxy</span> <span class="operator">=</span> (Calculator) getProxy(target);</span><br><span class="line">		calculatorProxy.add(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">		calculatorProxy.subtract(<span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Object <span class="title function_">getProxy</span><span class="params">(<span class="keyword">final</span> Object target)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">		<span class="type">Object</span> <span class="variable">proxy</span> <span class="operator">=</span> Proxy.newProxyInstance(</span><br><span class="line">				target.getClass().getClassLoader(),<span class="comment">/*类加载器*/</span></span><br><span class="line">				target.getClass().getInterfaces(),<span class="comment">/*让代理对象和目标对象实现相同接口*/</span></span><br><span class="line">				<span class="keyword">new</span> <span class="title class_">InvocationHandler</span>()&#123;<span class="comment">/*代理对象的方法最终都会被JVM导向它的invoke方法*/</span></span><br><span class="line">					<span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">						System.out.println(method.getName() + <span class="string">&quot;方法开始执行...&quot;</span>);</span><br><span class="line">						<span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> method.invoke(target, args);</span><br><span class="line">						System.out.println(result);</span><br><span class="line">						System.out.println(method.getName() + <span class="string">&quot;方法执行结束...&quot;</span>);</span><br><span class="line">						<span class="keyword">return</span> result;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">		);</span><br><span class="line">		<span class="keyword">return</span> proxy;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/16/java%E5%9F%BA%E7%A1%80/%E5%BC%80%E5%8F%91%E5%B8%B8%E7%94%A8%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/16/java%E5%9F%BA%E7%A1%80/%E5%BC%80%E5%8F%91%E5%B8%B8%E7%94%A8%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">开发常用笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-16 21:02:23" itemprop="dateCreated datePublished" datetime="2021-02-16T21:02:23+08:00">2021-02-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:45:24" itemprop="dateModified" datetime="2023-02-08T00:45:24+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">java基础</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="DTO-常用注解"><a href="#DTO-常用注解" class="headerlink" title="DTO 常用注解"></a>DTO 常用注解</h1><h2 id="javax-validation"><a href="#javax-validation" class="headerlink" title="javax.validation"></a>javax.validation</h2><p>配合使用：controller 参数前加上@Valid</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.format.annotation.DateTimeFormat;</span><br><span class="line"><span class="keyword">import</span> org.springframework.format.annotation.DateTimeFormat;</span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ValidatorPojo</span> &#123;</span><br><span class="line">	<span class="meta">@NotNull(message = &quot;id不能为空&quot;)</span> <span class="comment">// 非空判断</span></span><br><span class="line">	<span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Future(message = &quot;需要一个将来日期&quot;)</span> <span class="comment">// 只能是将来的日期</span></span><br><span class="line">	<span class="comment">// @Past //只能去过去的日期</span></span><br><span class="line">	<span class="meta">@DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;)</span> <span class="comment">// 日期格式化转换</span></span><br><span class="line">	<span class="meta">@NotNull</span> <span class="comment">// 不能为空</span></span><br><span class="line">	<span class="keyword">private</span> Date date;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@NotNull</span> <span class="comment">// 不能为空</span></span><br><span class="line">	<span class="meta">@DecimalMin(value = &quot;0.1&quot;)</span> <span class="comment">// 最小值0.1元</span></span><br><span class="line">	<span class="meta">@DecimalMax(value = &quot;10000.00&quot;)</span> <span class="comment">// 最大值10000元</span></span><br><span class="line">	<span class="keyword">private</span> <span class="type">Double</span> <span class="variable">doubleValue</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Min(value = 1, message = &quot;最小值为1&quot;)</span> <span class="comment">// 最小值为1</span></span><br><span class="line">	<span class="meta">@Max(value = 88, message = &quot;最大值为88&quot;)</span> <span class="comment">// 最大值88</span></span><br><span class="line">	<span class="meta">@NotNull</span> <span class="comment">// 不能为空</span></span><br><span class="line">	<span class="keyword">private</span> Integer integer;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Range(min = 1, max = 888, message = &quot;范围为1至888&quot;)</span> <span class="comment">// 限定范围</span></span><br><span class="line">	<span class="keyword">private</span> Long range;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 邮箱验证</span></span><br><span class="line">	<span class="meta">@Email(message = &quot;邮箱格式错误&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String email;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Size(min = 20, max = 30, message = &quot;字符串长度要求20到30之间。&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> String size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="NotNull："><a href="#NotNull：" class="headerlink" title="@NotNull："></a>@NotNull：</h4><p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/Fm8cxsvHsw7J15bBhdZd6kW6d1P1.png"></p>
<h4 id="NotEmpty："><a href="#NotEmpty：" class="headerlink" title="@NotEmpty："></a>@NotEmpty：</h4><p>@NotNull + @Size(min = 1)</p>
<h4 id="NotBlank"><a href="#NotBlank" class="headerlink" title="@NotBlank:"></a>@NotBlank:</h4><p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FoNr8QXaHkuPqquecfDFIkfJP7GZ.png"></p>
<hr>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/11/%E5%88%86%E5%B8%83%E5%BC%8F/CAP%E5%AE%9A%E7%90%86%E4%B8%8EBASE%E7%90%86%E8%AE%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/11/%E5%88%86%E5%B8%83%E5%BC%8F/CAP%E5%AE%9A%E7%90%86%E4%B8%8EBASE%E7%90%86%E8%AE%BA/" class="post-title-link" itemprop="url">CAP定理与BASE理论</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-11 01:14:46" itemprop="dateCreated datePublished" datetime="2021-02-11T01:14:46+08:00">2021-02-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:20:03" itemprop="dateModified" datetime="2023-02-08T00:20:03+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">分布式</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-CAP"><a href="#1-CAP" class="headerlink" title="1 CAP"></a>1 CAP</h1><p>CA 只能二选一</p>
<ul>
<li>C（consistency）<ul>
<li>（强）一致性：写操作完成后，所有的读操作都能看到最新的数据</li>
</ul>
</li>
<li>A（Availability）<ul>
<li>可用性：每次向未崩溃的节点发送请求，总能保证收到响应数据</li>
</ul>
</li>
<li>P（PartitionTolerance）<ul>
<li>分区容错性：容许节点间传递消息的差错（延迟或丢失）</li>
</ul>
</li>
</ul>
<h1 id="2-BASE"><a href="#2-BASE" class="headerlink" title="2 BASE"></a>2 BASE</h1><blockquote>
<p>即使无法做到强一致性（Strong consistency），但每个应用都可以根据自身的业务特点，采用适当的方式来使系统达到最终一致性（Eventual consistency）。</p>
</blockquote>
<ul>
<li>Basically Available（基本可用）</li>
<li>Soft state（软状态）</li>
<li>Eventually consistent（最终一致性）</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FlXkqNXDgYzbzpSMLxQ_rBQgpqBD.png"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/09/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%B8%8E%E5%AE%89%E5%85%A8/Oauth2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/09/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%B8%8E%E5%AE%89%E5%85%A8/Oauth2/" class="post-title-link" itemprop="url">Oauth2</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-09 16:38:52" itemprop="dateCreated datePublished" datetime="2021-02-09T16:38:52+08:00">2021-02-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:20:43" itemprop="dateModified" datetime="2023-02-08T00:20:43+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%B8%8E%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">计算机网络与安全</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2019/04/oauth-grant-types.html">http://www.ruanyifeng.com/blog/2019/04/oauth-grant-types.html</a></p>
<blockquote>
<p><strong>OAuth 的核心就是向第三方应用颁发令牌</strong></p>
</blockquote>
<h1 id="1-颁发令牌的方式"><a href="#1-颁发令牌的方式" class="headerlink" title="1 颁发令牌的方式"></a>1 颁发令牌的方式</h1><ul>
<li>不管哪一种授权方式，第三方应用申请令牌之前，都必须先到系统备案，说明自己的身份，然后会拿到两个身份识别码：客户端 ID（<strong>client ID</strong>）和客户端密钥（<strong>client secret</strong>）。这是为了防止令牌被滥用，没有备案过的第三方应用，是不会拿到令牌的。</li>
</ul>
<h2 id="1-1-授权码模式（authorization-code）"><a href="#1-1-授权码模式（authorization-code）" class="headerlink" title="1.1 授权码模式（authorization-code）"></a>1.1 授权码模式（authorization-code）</h2><p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FiqldvBtH6FSTyFk4sUo7F05kE-A.png"></p>
<ul>
<li>A. Client 提供一个 url，用户点击后跳转至认证服务器<ul>
<li><a target="_blank" rel="noopener" href="https://b.com/oauth/authorize">https://b.com/oauth/authorize</a>?response_type=code&amp;client_id=CLIENT_ID&amp;redirect_uri=CALLBACK_URL&amp;scope=read</li>
</ul>
</li>
<li>B. 用户在认证服务器登陆并同意授权</li>
<li>C. 认证服务器返回 AuthorizationCode 给 Client3<ul>
<li>通过跳转 CALLBACK_URL 并携带 code 方式：<a href="https://CALLBACK_URL[?code=AUTHORIZATION_CODE](https://a.com/callback?code=AUTHORIZATION_CODE)">https://CALLBACK_URL[?code=AUTHORIZATION_CODE](https://a.com/callback?code=AUTHORIZATION_CODE)</a></li>
<li>此 code 用户可见</li>
</ul>
</li>
<li>D. Client 用 code 交换 AccessToken<ul>
<li><a target="_blank" rel="noopener" href="https://b.com/oauth/token">https://b.com/oauth/token</a>?client_id=CLIENT_ID&amp;client_secret=CLIENT_SECRET&amp;grant_type=authorization_code&amp;code=AUTHORIZATION_CODE&amp;redirect_uri=CALLBACK_URL</li>
</ul>
</li>
<li>E. 认证服务器向 redirect_uri 指定的网址，发送一段 JSON 数据。<ul>
<li>JSON 中包含 token 信息</li>
</ul>
</li>
</ul>
<h2 id="1-2-隐藏模式（implicit）"><a href="#1-2-隐藏模式（implicit）" class="headerlink" title="1.2 隐藏模式（implicit）"></a>1.2 隐藏模式（implicit）</h2><p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/Fn1XnmdUqv8EyxXbOFOdGgioGbHj.png"></p>
<ul>
<li>相比 1.1 授权码方式，减少了 code 这一中间步骤，直接返回 token<ul>
<li><a target="_blank" rel="noopener" href="https://a.com/callback#token=ACCESS_TOKEN">https://a.com/callback#token=ACCESS_TOKEN</a></li>
</ul>
</li>
<li>较 1.1 授权码模式，implicit 模式不安全</li>
</ul>
<h2 id="1-3-密码模式（password）"><a href="#1-3-密码模式（password）" class="headerlink" title="1.3 密码模式（password）"></a>1.3 密码模式（password）</h2><p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FpS9U_wJNgwj-xqyJObHt3lhAO5K.png"></p>
<ul>
<li>该模式用于用户完全对 Client 信任的场景</li>
</ul>
<h2 id="1-4-客户端凭证模式（client-credentials）"><a href="#1-4-客户端凭证模式（client-credentials）" class="headerlink" title="1.4 客户端凭证模式（client credentials）"></a>1.4 客户端凭证模式（client credentials）</h2><p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/Fi41Rnts79DuYxiBWfcm1Qb9vTtR.png"></p>
<ul>
<li>A. Client 以应用的名义向认证服务器发起请求<ul>
<li><a target="_blank" rel="noopener" href="https://oauth.b.com/token">https://oauth.b.com/token?</a>grant_type=client_credentials&amp;client_id=CLIENT_ID&amp;client_secret=CLIENT_SECRET</li>
</ul>
</li>
<li>B. 直接返回 token</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/09/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%B8%8E%E5%AE%89%E5%85%A8/UAA-%E8%AE%A4%E8%AF%81%E6%9C%8D%E5%8A%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/09/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%B8%8E%E5%AE%89%E5%85%A8/UAA-%E8%AE%A4%E8%AF%81%E6%9C%8D%E5%8A%A1/" class="post-title-link" itemprop="url">UAA-认证服务</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-09 16:35:40" itemprop="dateCreated datePublished" datetime="2021-02-09T16:35:40+08:00">2021-02-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:20:49" itemprop="dateModified" datetime="2023-02-08T00:20:49+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%B8%8E%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">计算机网络与安全</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>UAA（User Account and Authentication）<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yorkwu/p/9572151.html">https://www.cnblogs.com/yorkwu/p/9572151.html</a></p>
</blockquote>
<ul>
<li>认证方式<ul>
<li>oauth2<ul>
<li>密码模式</li>
<li>客户端模式</li>
</ul>
</li>
<li>JWT<ul>
<li>非对称加密方式实现数字签名</li>
</ul>
</li>
</ul>
</li>
<li>密码加密方式<ul>
<li>Bcrypt 加盐摘要</li>
</ul>
</li>
</ul>
<h1 id="0-认证流程"><a href="#0-认证流程" class="headerlink" title="0 认证流程"></a>0 认证流程</h1><p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FvTXy1tZezoR5BZnP5-SLk07Xmn1.png"></p>
<h1 id="1-认证方式"><a href="#1-认证方式" class="headerlink" title="1 认证方式"></a>1 认证方式</h1><h2 id="1-1-oauth2-–-password"><a href="#1-1-oauth2-–-password" class="headerlink" title="1.1 oauth2 – password"></a>1.1 oauth2 – password</h2><p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FrC4d3hBIvkCOeUau3zQc_2IfG8q.png"></p>
<h2 id="1-2-oauth2-–-client-credentials"><a href="#1-2-oauth2-–-client-credentials" class="headerlink" title="1.2 oauth2 – client credentials"></a>1.2 oauth2 – client credentials</h2><p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FqDkg-zCkKvAId2ONA4XnDLbtEuI.png"><br><em>注：这种认证方式是用在内部服务之间调用的场景，也就是服务间调用时是没有用户名和密码信息的。</em></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/07/%E6%95%B0%E6%8D%AE%E5%BA%93/redis/Redis-6-%E5%8D%95%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%A4%9A%E7%BA%BF%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/07/%E6%95%B0%E6%8D%AE%E5%BA%93/redis/Redis-6-%E5%8D%95%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%A4%9A%E7%BA%BF%E7%A8%8B/" class="post-title-link" itemprop="url">Redis-单线程与多线程</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-07 18:28:20" itemprop="dateCreated datePublished" datetime="2021-02-07T18:28:20+08:00">2021-02-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:38:07" itemprop="dateModified" datetime="2023-02-08T00:38:07+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/redis/" itemprop="url" rel="index"><span itemprop="name">redis</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-Redis4-0-前"><a href="#1-Redis4-0-前" class="headerlink" title="1 Redis4.0 前"></a>1 Redis4.0 前</h1><p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FkeO1VLueRdIKpUdD0AB0qZFVkMr.png"></p>
<ul>
<li><strong>可维护性</strong>好<ul>
<li>串行执行代码</li>
<li>程序执行顺序确定</li>
<li>不用考虑竞争条件，锁的问题</li>
</ul>
</li>
<li><strong>IO 多路复用</strong>并发处理客户端多个连接<ul>
<li>不再需要额外创建和维护线程来监听来自客户端的大量连接</li>
</ul>
</li>
<li>绝大多数操作的<strong>性能瓶颈</strong>都不是 CPU<ul>
<li>瓶颈在网络 I/O，内存</li>
</ul>
</li>
<li>使用多线程<strong>线程切换开销</strong><ul>
<li>多线程虽然会帮助我们更充分地利用 CPU 资源，但是线程切换会带来额外的开销，其中包括：<ul>
<li>保存线程 1 的执行上下文；</li>
<li>加载线程 2 的执行上下文；</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h1 id="2-Reids4-0-～-Redis6-0"><a href="#2-Reids4-0-～-Redis6-0" class="headerlink" title="2 Reids4.0 ～ Redis6.0"></a>2 Reids4.0 ～ Redis6.0</h1><p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FjwGcJmQgXLicUOpiXTd51Lq7Fyt.png"></p>
<ul>
<li>workThread 执行命令依旧是串行<ul>
<li>部分删除命令异步执行（<code>FLUSHALL ASYNC</code> ，<code>FLUSHDB ASYNC</code>，<code>UNLINK</code>）<ul>
<li>key 都同步删除</li>
<li>value 在评估大小后，若大则由后台线程异步删除</li>
</ul>
</li>
</ul>
</li>
<li>引用多线程原因<ul>
<li>如果待删除的键值对占用了较小的内存空间，那么哪怕同步地删除这些键值对也不会消耗太多的时间。</li>
<li>但是对于一些超大键值对，几十 MB 或者几百 MB 的数据并不能在几毫秒的时间内处理完，Redis 可能会需要在释放内存空间上消耗较多的时间，这些操作就会阻塞待处理的任务</li>
</ul>
</li>
</ul>
<hr>
<h1 id="3-Reids6-0-及以后"><a href="#3-Reids6-0-及以后" class="headerlink" title="3 Reids6.0 及以后"></a>3 Reids6.0 及以后</h1><p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FvWlprhAlUxTTALYn4p8pexDqTUX.png"></p>
<ul>
<li>多个 I/O 线程</li>
</ul>
<p><code>I/O 多路复用模块收到数据包之后将其丢给后面多个 I/O 线程进行解析，I/O 线程处理结束后，主线程会负责串行的执行这些命令，由于向客户端发回数据包的过程也是比较耗时的，所以执行之后的结果也会交给多个 I/O 线程发送回客户端。</code><br>io 线程可以自己配置，官网建议 4 个（io 线程可以复用）</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/07/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/07/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/Mysql/" class="post-title-link" itemprop="url">Mysql</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-07 17:19:38" itemprop="dateCreated datePublished" datetime="2021-02-07T17:19:38+08:00">2021-02-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:34:39" itemprop="dateModified" datetime="2023-02-08T00:34:39+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="ACID"><a href="#ACID" class="headerlink" title="ACID"></a>ACID</h1><h2 id="原子性（Atomicity）"><a href="#原子性（Atomicity）" class="headerlink" title="原子性（Atomicity）"></a>原子性（Atomicity）</h2><ul>
<li>基于日志的<code>Redo/Undo</code>机制<ul>
<li>Redo Log：Redo log 用来记录某数据块被修改后的值，可以用来恢复未写入 data file 的已成功事务更新的数据</li>
<li>Undo Log：Undo log 是用来记录数据更新前的值，保证数据更新失败能够回滚。</li>
</ul>
</li>
</ul>
<p>假如某个时刻数据库崩溃，在崩溃之前有事务 A 和事务 B 在执行，事务 A 已经提交，而事务 B 还未提交。当数据库重启进行 crash-recovery 时，就会通过 Redo log 将已经提交事务的更改写到数据文件，而还没有提交的就通过 Undo log 进行 roll back。</p>
<h2 id="一致性（Consistent）"><a href="#一致性（Consistent）" class="headerlink" title="一致性（Consistent）"></a>一致性（Consistent）</h2><h2 id="隔离性（Isalotion）"><a href="#隔离性（Isalotion）" class="headerlink" title="隔离性（Isalotion）"></a>隔离性（Isalotion）</h2><h2 id="持久性-Durable"><a href="#持久性-Durable" class="headerlink" title="持久性(Durable)"></a>持久性(Durable)</h2><hr>
<h1 id="隔离级别"><a href="#隔离级别" class="headerlink" title="隔离级别"></a>隔离级别</h1><ul>
<li><strong>读未提交（READ UNCOMMITTED）</strong><ul>
<li><strong>脏读问题</strong></li>
</ul>
</li>
<li><strong>读提交 （READ COMMITTED）</strong><ul>
<li><strong>解决脏读问题</strong></li>
<li><strong>有不可重复读问题（update）</strong></li>
</ul>
</li>
<li><strong>可重复读 （REPEATABLE READ）</strong><ul>
<li><strong>解决了不可重复读问题</strong></li>
<li><strong>有幻读问题（insert）</strong></li>
</ul>
</li>
<li><strong>串行化 （SERIALIZABLE）</strong><ul>
<li><strong>解决所有问题</strong></li>
</ul>
</li>
</ul>
<h2 id="MVCC-多版本并发控制）"><a href="#MVCC-多版本并发控制）" class="headerlink" title="MVCC(多版本并发控制）"></a>MVCC(多版本并发控制）</h2><p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/Fult8Bxn6TqZ2BawoKlb_viu46HY.png"></p>
<ul>
<li>在 InnoDB 中每一个事务都有一个自己的事务 id，并且是唯一的，递增的 。</li>
<li>对于 Mysql 中的每一个数据行都有可能存在多个版本，在每次事务更新数据的时候，都会生成一个新的数据版本，并且把自己的事务 id 赋值给当前版本的 row trx_id。</li>
<li>版本 1、版本 2 并非实际物理存在的</li>
<li>U1 和 U2 实际就是 undo log，这 v1 和 v2 版本是根据当前 v3 和 undo log 计算出来的</li>
</ul>
<hr>
<h1 id="锁"><a href="#锁" class="headerlink" title="锁"></a>锁</h1><h2 id="共享锁-排他锁"><a href="#共享锁-排他锁" class="headerlink" title="共享锁/排他锁"></a>共享锁/排他锁</h2><p>共享锁是针对同一份数据，多个读操作可以同时进行，简单来说即读加锁，不能写并且可并行读；<br>排他锁针对写操作，假如当前写操作没有完成，那么它会阻断其它的写锁和读锁，即写加锁，其它读写都阻塞 。</p>
<h2 id="行锁-表锁"><a href="#行锁-表锁" class="headerlink" title="行锁/表锁"></a>行锁/表锁</h2><p>是从锁的粒度上进行划分的，行锁锁定当前数据行，锁的粒度小，加锁慢，发生锁冲突的概率小，并发度高，行锁也是 MyISAM 和 InnoDB 的区别之一，InnoDB 支持行锁并且支持事务 。<br>表锁则锁的粒度大，加锁快，开销小，但是锁冲突的概率大，并发度低。</p>
<h2 id="两个事务执行写操作，怎么保证并发？"><a href="#两个事务执行写操作，怎么保证并发？" class="headerlink" title="两个事务执行写操作，怎么保证并发？"></a>两个事务执行写操作，怎么保证并发？</h2><ul>
<li>有索引：<ul>
<li>事务 1 先 update 数据行的时候，先回获取行锁，锁定数据，当事务 2 要进行 update 操作的时候，也会取获取该数据行的行锁，但是已经被事务 1 占有，事务 2 只能 wait。</li>
</ul>
</li>
<li>无索引：<ul>
<li>获取所有行，都加上行锁，然后 Mysql 会再次过滤符合条件的的行并释放锁，只有符合条件的行才会继续持有锁。</li>
<li>性能消耗大</li>
</ul>
</li>
</ul>
<hr>
<h1 id=""><a href="#" class="headerlink" title=""></a></h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/07/%E6%95%B0%E6%8D%AE%E5%BA%93/redis/Redis-5-%E4%BA%8B%E5%8A%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/07/%E6%95%B0%E6%8D%AE%E5%BA%93/redis/Redis-5-%E4%BA%8B%E5%8A%A1/" class="post-title-link" itemprop="url">Redis-事务</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-07 10:00:54" itemprop="dateCreated datePublished" datetime="2021-02-07T10:00:54+08:00">2021-02-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:37:58" itemprop="dateModified" datetime="2023-02-08T00:37:58+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/redis/" itemprop="url" rel="index"><span itemprop="name">redis</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li>一次执行多条命令<ul>
<li>批量操作在发送 EXEC 命令前被放入队列缓存。</li>
<li>收到 EXEC 命令后进入事务执行，事务中任意命令执行失败，其余的命令<strong>依然被执行（不会回滚）</strong>。</li>
<li>在事务执行过程，其他客户端提交的命令请求不会插入到事务执行命令序列中。</li>
</ul>
</li>
<li>阶段<ul>
<li>开始事务。</li>
<li>命令入队。</li>
<li>执行事务。</li>
</ul>
</li>
<li>事务命令：<br>| 1 | <a target="_blank" rel="noopener" href="https://www.runoob.com/redis/transactions-discard.html">DISCARD</a><br>取消事务，放弃执行事务块内的所有命令。 |<br>| — | — |<br>| 2 | <a target="_blank" rel="noopener" href="https://www.runoob.com/redis/transactions-exec.html">EXEC</a><br>执行所有事务块内的命令。 |<br>| 3 | <a target="_blank" rel="noopener" href="https://www.runoob.com/redis/transactions-multi.html">MULTI</a><br>标记一个事务块的开始。 |<br>| 4 | <a target="_blank" rel="noopener" href="https://www.runoob.com/redis/transactions-unwatch.html">UNWATCH</a><br>取消 WATCH 命令对所有 key 的监视。 |<br>| 5 | <a target="_blank" rel="noopener" href="https://www.runoob.com/redis/transactions-watch.html">WATCH key [key …]</a><br>监视一个(或多个) key ，如果在事务执行之前这个(或这些) key 被其他命令所改动，那么事务将被打断。 |</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/07/%E6%95%B0%E6%8D%AE%E5%BA%93/redis/Redis-7-%E6%8C%81%E4%B9%85%E5%8C%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/07/%E6%95%B0%E6%8D%AE%E5%BA%93/redis/Redis-7-%E6%8C%81%E4%B9%85%E5%8C%96/" class="post-title-link" itemprop="url">Redis-持久化</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-07 09:53:42" itemprop="dateCreated datePublished" datetime="2021-02-07T09:53:42+08:00">2021-02-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:38:15" itemprop="dateModified" datetime="2023-02-08T00:38:15+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/redis/" itemprop="url" rel="index"><span itemprop="name">redis</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="7-持久化"><a href="#7-持久化" class="headerlink" title="7 持久化"></a>7 持久化</h1><h2 id="7-1-RDB"><a href="#7-1-RDB" class="headerlink" title="7.1 RDB"></a>7.1 RDB</h2><ul>
<li>全量持久化</li>
</ul>
<p>fork 和 cow。<br>fork 是指 redis 通过创建子进程来进行 RDB 操作，<br>cow 指的是 copy on write，子进程创建后，父子进程共享数据段，父进程继续提供读写服务，写脏的页面数据会逐渐和子进程分离开来。</p>
<h2 id="7-2-AOF"><a href="#7-2-AOF" class="headerlink" title="7.2 AOF"></a>7.2 AOF</h2><ul>
<li>使用 AOF 持久时，服务会将每个收到的写命令通过写函数追加到文件中（appendonly.aof）</li>
<li>AOF 持久化存储方式参数说明<ul>
<li>appendonly  yes                  #开启 AOF 持久化存储方式</li>
<li>appendfsync   always           #收到写命令后就立即写入磁盘，效率最差，效果最好</li>
<li>appendfsync   everysec        #每秒写入磁盘一次     效率与效果居中</li>
<li>appendfsync   no                 #完全依赖操作系统，效率最佳，效果没法保证</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">110</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">32</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
