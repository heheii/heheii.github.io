<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/10/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/10/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hexo</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/09/16/java%E5%9F%BA%E7%A1%80/Java8%E6%96%B0%E7%89%B9%E6%80%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/16/java%E5%9F%BA%E7%A1%80/Java8%E6%96%B0%E7%89%B9%E6%80%A7/" class="post-title-link" itemprop="url">Java8新特性</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-16 14:18:59" itemprop="dateCreated datePublished" datetime="2020-09-16T14:18:59+08:00">2020-09-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:45:24" itemprop="dateModified" datetime="2023-02-08T00:45:24+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">java基础</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-接口的默认方法"><a href="#1-接口的默认方法" class="headerlink" title="1 接口的默认方法"></a>1 接口的默认方法</h1><h1 id="2-Lambda-表达式"><a href="#2-Lambda-表达式" class="headerlink" title="2 Lambda 表达式"></a>2 Lambda 表达式</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//匿名内部类方式</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sort</span><span class="params">(List list)</span>&#123;</span><br><span class="line">    Collections.sort(list, <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;String&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(String o1, String o2)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> o1.compareTo(o2);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//lambda表达式</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">lambdaSort00</span><span class="params">(List&lt;String&gt; list)</span>&#123;</span><br><span class="line">    Collections.sort(list, (String x,String y) -&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> x.compareTo(y);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//函数体只有一行代码时，你可以去掉大括号以及return关键字</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">lambdaSort01</span><span class="params">(List&lt;String&gt; list)</span>&#123;</span><br><span class="line">    Collections.sort(list, (String x,String y) -&gt; x.compareTo(y));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//编译器可以自动推导出参数类型，所以你可以不用再写一次类型</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">lambdaSort02</span><span class="params">(List&lt;String&gt; list)</span>&#123;</span><br><span class="line">    Collections.sort(list, (x,y) -&gt; x.compareTo(y));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="3-函数式接口"><a href="#3-函数式接口" class="headerlink" title="3 函数式接口"></a>3 函数式接口</h1><ul>
<li>函数式接口(Functional Interface)就是一个<strong>有且仅有一个抽象方法</strong>，但是可以有多个非抽象方法的接口。</li>
<li>可以使用 Lambda 表达式来表示<strong>该接口的一个实现。</strong></li>
<li>接口添加** @FunctionalInterface** 注解，编译器如果发现标注了这个注解的接口有多于一个抽象方法的时候会报错</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FsZ8jRvZ0p7yR76lIdc89H0owgBf.png"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//JAVA 8 之前一般是用匿名类实现的</span></span><br><span class="line"><span class="type">Runnable</span> <span class="variable">runnable</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//可以使用Lambda表达式来表示该接口的一个实现</span></span><br><span class="line"><span class="type">Runnable</span> <span class="variable">runnable</span> <span class="operator">=</span> () -&gt; System.out.println(<span class="string">&quot;test&quot;</span>);</span><br></pre></td></tr></table></figure>

<h1 id="4-方法引用"><a href="#4-方法引用" class="headerlink" title="4 方法引用"></a>4 方法引用</h1><ul>
<li>根据<strong>已有的</strong>方法实现来创建 Lambda 表达式</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Lambda表达式</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">lambdaSort02</span><span class="params">(List&lt;String&gt; list)</span>&#123;</span><br><span class="line">    Collections.sort(list, (x,y)-&gt;x.compareTo(y));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//引用 类静态方法</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">lambdaSort03</span><span class="params">(List&lt;String&gt; list)</span>&#123;</span><br><span class="line">    Collections.sort(list, MyCompareTest::myStaticCompare);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//引用 实例方法</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">lambdaSort04</span><span class="params">(List&lt;String&gt; list)</span>&#123;</span><br><span class="line">    Collections.sort(list, <span class="keyword">new</span> <span class="title class_">MyCompareTest</span>()::myCompare);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: wqc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span>: 2020-09-16 15:38</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyCompareTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">myCompare</span><span class="params">(String s1, String s2)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> s1.compareTo(s2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">myStaticCompare</span> <span class="params">(String s1, String s2)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> s1.compareTo(s2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="5-Stream"><a href="#5-Stream" class="headerlink" title="5 Stream"></a>5 Stream</h1><ul>
<li>Java 8 新增的 Stream 是为了方便操作集合（<strong>Collection</strong>）。</li>
<li>每次操作流都会返回一个新的流对象，方便进行链式操作，但<strong>原有的流对象会保持不变</strong>。</li>
</ul>
<h2 id="5-1-创建流"><a href="#5-1-创建流" class="headerlink" title="5.1 创建流"></a>5.1 创建流</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//数组创建流（方式一）</span></span><br><span class="line">String[] arr = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;AAA&quot;</span>, <span class="string">&quot;BBB&quot;</span>, <span class="string">&quot;CCC&quot;</span>&#125;;</span><br><span class="line">Stream&lt;String&gt; stream = Arrays.stream(arr);</span><br><span class="line"><span class="comment">//数组创建流（方式二）</span></span><br><span class="line">stream = Stream.of(<span class="string">&quot;AAA&quot;</span>, <span class="string">&quot;BBB&quot;</span>, <span class="string">&quot;CCC&quot;</span>);</span><br><span class="line"></span><br><span class="line">List&lt;String&gt; list = Arrays.asList(<span class="string">&quot;AAA&quot;</span>, <span class="string">&quot;BBB&quot;</span>, <span class="string">&quot;CCC&quot;</span>);</span><br><span class="line"><span class="comment">//集合创建流</span></span><br><span class="line">stream = list.stream();</span><br><span class="line"><span class="comment">//集合创建并发流</span></span><br><span class="line">stream = list.parallelStream();</span><br></pre></td></tr></table></figure>

<h2 id="5-2-操作流"><a href="#5-2-操作流" class="headerlink" title="5.2 操作流"></a>5.2 操作流</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = Arrays.asList(<span class="string">&quot;AAA&quot;</span>, <span class="string">&quot;BBB&quot;</span>, <span class="string">&quot;CCC&quot;</span>, <span class="string">&quot;DD&quot;</span>);</span><br><span class="line">Stream&lt;String&gt; stream = list.stream();</span><br><span class="line"><span class="comment">//过滤 输出：AAA</span></span><br><span class="line">list.stream().filter(elem -&gt; elem.contains(<span class="string">&quot;A&quot;</span>)).forEach(System.out::println);</span><br><span class="line"></span><br><span class="line"><span class="comment">//映射 输出：3 3 3 2</span></span><br><span class="line">list.stream().map(<span class="keyword">for</span>).forEach(System.out::println);</span><br><span class="line"></span><br><span class="line"><span class="comment">//匹配</span></span><br><span class="line">list.stream().anyMatch(element -&gt; element.contains(<span class="string">&quot;A&quot;</span>));</span><br><span class="line">list.stream().allMatch(element -&gt; element.length() &gt; <span class="number">1</span>);</span><br><span class="line">list.stream().noneMatch(element -&gt; element.endsWith(<span class="string">&quot;X&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//组合</span></span><br><span class="line">Optional&lt;String&gt; optional = list.stream().reduce((a, b) -&gt; a + b);</span><br><span class="line">System.out.println(optional.orElse(<span class="string">&quot;null&quot;</span>));</span><br><span class="line"><span class="comment">//&quot;test&quot;为起始值</span></span><br><span class="line">System.out.println(list.stream().reduce(<span class="string">&quot;test&quot;</span>, (a, b) -&gt; a + b));</span><br><span class="line"></span><br><span class="line"><span class="comment">//去重</span></span><br><span class="line">list.stream().distinct().forEach(System.out::println);</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除 输出：DD</span></span><br><span class="line">list.stream().skip(<span class="number">3</span>).forEach(System.out::println);</span><br><span class="line"></span><br><span class="line"><span class="comment">//求最小值 输出：Optional[AAA]</span></span><br><span class="line">list.stream().min(String::compareTo);</span><br></pre></td></tr></table></figure>

<h3 id="5-2-1-中间操作之-map-与-flatMap"><a href="#5-2-1-中间操作之-map-与-flatMap" class="headerlink" title="5.2.1 中间操作之 map 与 flatMap"></a>5.2.1 中间操作之 map 与 flatMap</h3><ul>
<li>map</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">String[] words = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;Hello&quot;</span>,<span class="string">&quot;World&quot;</span>&#125;;</span><br><span class="line">List&lt;String[]&gt; a = Arrays.stream(words)</span><br><span class="line">    .map(word -&gt; word.split(<span class="string">&quot;&quot;</span>))</span><br><span class="line">    .distinct()</span><br><span class="line">    .collect(toList());</span><br><span class="line">a.forEach(System.out::print);</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/Fo6U7gmF-YArcyUvG8UbySUGq4S0.png"></p>
<ul>
<li>flatMap(对流扁平化处理)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">String[] words = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;Hello&quot;</span>,<span class="string">&quot;World&quot;</span>&#125;;</span><br><span class="line">List&lt;String&gt; a = Arrays.stream(words)</span><br><span class="line">    .map(word -&gt; word.split(<span class="string">&quot;&quot;</span>))</span><br><span class="line">    .flatMap(Arrays::stream)</span><br><span class="line">    .distinct()</span><br><span class="line">    .collect(toList());</span><br><span class="line">a.forEach(System.out::print);</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/Fo1t0Yi-LEUwu3A3Xmh8JL8tj9g4.png"></p>
<h2 id="5-3-terminal-operation"><a href="#5-3-terminal-operation" class="headerlink" title="5.3 terminal operation"></a>5.3 terminal operation</h2><p>Collectors 就是一个 collector 工厂，原理如下图：<br><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FpXafat2yx1Ch5zSgj12bBQNFbe0.png"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//流转化为List</span></span><br><span class="line">list.stream().collect(Collectors.toList());</span><br><span class="line">list.stream().collect(Collectors.toCollection(ArrayList::<span class="keyword">new</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 流转化为Map</span></span><br><span class="line">list.stream().collect(Collectors.toMap(DTO::getId,</span><br><span class="line">                                       Function.identity(),</span><br><span class="line">                                       (newData, oldData) -&gt; newData));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 去重1</span></span><br><span class="line">list.stream()</span><br><span class="line">    .collect(Collectors.collectingAndThen(Collectors.toCollection(() -&gt; <span class="keyword">new</span> <span class="title class_">TreeSet</span>&lt;&gt;(Comparator.comparing(dto::getName))), ArrayList::<span class="keyword">new</span>));</span><br><span class="line"><span class="comment">// 去重2</span></span><br><span class="line">list.stream()</span><br><span class="line">    .collect(Collectors.groupingBy(dto::getName));</span><br></pre></td></tr></table></figure>

<h1 id="6-新增的接口-类"><a href="#6-新增的接口-类" class="headerlink" title="6 新增的接口/类"></a>6 新增的接口/类</h1><h2 id="6-1-函数式接口"><a href="#6-1-函数式接口" class="headerlink" title="6.1 函数式接口"></a>6.1 <strong>函数式接口</strong></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// x -&gt; y</span></span><br><span class="line">Function&lt;Integer, Integer&gt; function = x -&gt; x + <span class="number">5</span>;</span><br><span class="line">System.out.println(function.apply(<span class="number">3</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// () -&gt; y</span></span><br><span class="line">Supplier&lt;Integer&gt; supplier = () -&gt; <span class="number">5</span>;</span><br><span class="line">System.out.println(supplier.get());</span><br><span class="line"></span><br><span class="line"><span class="comment">// x -&gt; ()</span></span><br><span class="line">Consumer&lt;Integer&gt; consumer = System.out::println;</span><br><span class="line">consumer.accept(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// (x, y) -&gt; ()</span></span><br><span class="line">BiConsumer&lt;Integer, Integer&gt; biConsumer = (x, y) -&gt; System.out.println(x + y);</span><br><span class="line">biConsumer.accept(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// x -&gt; Boolean</span></span><br><span class="line">Predicate&lt;Integer&gt; predicate = x -&gt; x &gt; <span class="number">5</span>;</span><br><span class="line">System.out.println(predicate.test(<span class="number">5</span>));</span><br></pre></td></tr></table></figure>

<h2 id="6-2-Optional-类"><a href="#6-2-Optional-类" class="headerlink" title="6.2 Optional 类"></a>6.2 <strong>Optional 类</strong></h2><ul>
<li>防止 NullPointerException</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/09/15/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E6%A1%86%E6%9E%B6/%E8%84%9A%E6%89%8B%E6%9E%B6/JHipster/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/15/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E6%A1%86%E6%9E%B6/%E8%84%9A%E6%89%8B%E6%9E%B6/JHipster/" class="post-title-link" itemprop="url">JHipster</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-15 14:44:57" itemprop="dateCreated datePublished" datetime="2020-09-15T14:44:57+08:00">2020-09-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:55:33" itemprop="dateModified" datetime="2023-02-08T00:55:33+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">中间件与框架</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E6%A1%86%E6%9E%B6/%E8%84%9A%E6%89%8B%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">脚手架</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-简介"><a href="#1-简介" class="headerlink" title="1 简介"></a>1 简介</h1><ul>
<li>JHipster 或者称 Java Hipster，是一个应用代码产生器，能够创建 SpringBoot + AngularJS/React 的单体或分布式应用。</li>
<li>架构图：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FlPmOwGeNa_PdwivWrk11D4hPGkN.png"></p>
<h1 id="2-安装"><a href="#2-安装" class="headerlink" title="2 安装"></a>2 安装</h1><h2 id="2-1-安装-JDK"><a href="#2-1-安装-JDK" class="headerlink" title="2.1 安装 JDK"></a>2.1 安装 JDK</h2><p>官网推荐 jdk11，jdk1.8 也可</p>
<h2 id="2-2-安装-node-js（请使用-LTS-64-位版本-非-LTS-版本不再支持）"><a href="#2-2-安装-node-js（请使用-LTS-64-位版本-非-LTS-版本不再支持）" class="headerlink" title="2.2 安装 node.js（请使用 LTS 64 位版本, 非 LTS 版本不再支持）**"></a>2.2 安装 node.js（<strong>请使用 LTS 64 位版本, 非 LTS 版本不再支持</strong>）**</h2><p><strong>node：</strong>就是一个<strong>javascript 的运行环境（平台）</strong>，他不是一门语言，也不是 javascript 的框架。可以用来开发服务端应用程序，web 系统。其特点是体积小，快速，高性能。</p>
<ul>
<li>查看 node 版本：<ul>
<li><code>node -v</code></li>
</ul>
</li>
</ul>
<p><strong>npm：</strong>JavaScript 的包管理工具。类似 Java 中的 maven，gradle</p>
<ul>
<li>设置淘宝镜像<ul>
<li><code>npm config set registry </code><a target="_blank" rel="noopener" href="https://registry.npm.taobao.org/"><code>https://registry.npm.taobao.org</code></a></li>
</ul>
</li>
<li>查看 npm 的配置信息<ul>
<li><code>npm config list</code></li>
</ul>
</li>
</ul>
<h2 id="2-3-安装-JHipster"><a href="#2-3-安装-JHipster" class="headerlink" title="2.3 安装 JHipster"></a>2.3 安装 JHipster</h2><ul>
<li><code>npm install -g generator-jhipster</code></li>
</ul>
<h1 id="3-创建应用程序"><a href="#3-创建应用程序" class="headerlink" title="3 创建应用程序"></a>3 创建应用程序</h1><ul>
<li>创建一个生产应用程序的空目录<ul>
<li><code>mkdir jhipstertest</code></li>
</ul>
</li>
<li>进入目录，生成应用程序<ul>
<li><code>cd C:\Will\Study\workspace\jhipstertest</code></li>
<li><code>jhipster</code></li>
</ul>
</li>
<li>启动<ul>
<li><code>./mvnw</code></li>
</ul>
</li>
</ul>
<h1 id="3-项目结构"><a href="#3-项目结构" class="headerlink" title="3 项目结构"></a>3 项目结构</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/09/11/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/11/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/linux/" class="post-title-link" itemprop="url">Linux</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-11 10:30:38" itemprop="dateCreated datePublished" datetime="2020-09-11T10:30:38+08:00">2020-09-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:45:24" itemprop="dateModified" datetime="2023-02-08T00:45:24+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index"><span itemprop="name">操作系统</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-指令"><a href="#1-指令" class="headerlink" title="1. 指令"></a>1. 指令</h1><h2 id="1-1-docker"><a href="#1-1-docker" class="headerlink" title="1.1 docker"></a>1.1 docker</h2><p>systemctl stop docker.service<br>systemctl start docker.service<br>systemctl restart docker.service<br>systemctl status docker.service</p>
<p>–拉取镜像<br>docker pull how2j/tmall</p>
<p>–运行镜像<br>docker run -dit –privileged -p21:21 -p80:80 -p8080:8080 -p30000-30010:30000-30010 –name how2jtmall how2j/tmall:latest /usr/sbin/init</p>
<p>–检查端口<br>netstat -anp|grep 8080</p>
<p>–访问<br><a target="_blank" rel="noopener" href="http://192.168.0.128:8080/tmall/">http://192.168.0.128:8080/tmall/</a></p>
<p>–进入容器<br>docker exec -it how2jtmall /bin/bash</p>
<p>–退出容器<br>exit</p>
<hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl set-default graphical.target  # 将默认模式修改为图形界面模式</span><br><span class="line">systemctl set-default multi-user.target # 将默认模式修改为命令行模式</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/09/08/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E6%A1%86%E6%9E%B6/MapStruct/MapStruct/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/08/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E6%A1%86%E6%9E%B6/MapStruct/MapStruct/" class="post-title-link" itemprop="url">MapStruct</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-08 14:32:37" itemprop="dateCreated datePublished" datetime="2020-09-08T14:32:37+08:00">2020-09-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:55:33" itemprop="dateModified" datetime="2023-02-08T00:55:33+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">中间件与框架</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E6%A1%86%E6%9E%B6/MapStruct/" itemprop="url" rel="index"><span itemprop="name">MapStruct</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-简介"><a href="#1-简介" class="headerlink" title="1 简介"></a>1 简介</h1><ul>
<li><strong>官网</strong>：<a target="_blank" rel="noopener" href="https://mapstruct.org/">https://mapstruct.org/</a></li>
<li>MapStruct 是一个<strong>属性映射工具</strong>，只需要定义一个 Mapper 接口，MapStruct 就会自动实现这个映射接口，避免了复杂繁琐的映射实现</li>
<li>**@Mapper **注解的 **componentModel **属性用于指定自动生成的接口实现类的组件类型，支持四个值：<ul>
<li>**default: **默认的情况，mapstruct 不使用任何组件类型, 可以通过 Mappers.getMapper(Class)方式获取自动生成的实例对象。</li>
<li>**cdi: **the generated mapper is an application-scoped CDI bean and can be retrieved via @Inject</li>
<li><strong>spring:</strong> 生成的实现类上会自动添加@Component，可以通过 Spring 的@Autowired 方式注入</li>
<li>**jsr330: **生成的实现类上会添加@javax.inject.Named 和@Singleton 注解，可以通过 @Inject 注解获取</li>
</ul>
</li>
</ul>
<h1 id="2-应用"><a href="#2-应用" class="headerlink" title="2 应用"></a>2 应用</h1><h2 id="2-1-引入依赖："><a href="#2-1-引入依赖：" class="headerlink" title="2.1 引入依赖："></a>2.1 引入依赖：</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapstruct.version</span>&gt;</span>1.2.0.Final<span class="tag">&lt;/<span class="name">mapstruct.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 包含了一些必要的注解，例如@Mapping。若我们使用的JDK版本高于1.8，当我们在pom里面导入依赖时候，</span></span><br><span class="line"><span class="comment">		建议使用坐标是：org.mapstruct:mapstruct-jdk8，这可以帮助我们利用一些Java8的新特性。 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mapstruct<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapstruct-jdk8<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mapstruct.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!-- 注解处理器，根据注解自动生成mapper的实现。--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mapstruct<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapstruct-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mapstruct.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="2-2-定义接口"><a href="#2-2-定义接口" class="headerlink" title="2.2 定义接口"></a>2.2 定义接口</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.mapstruct.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper(componentModel = &quot;spring&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AgrSceneGroupTempRelMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">   	<span class="comment">//定义DTO与entity之间字段关系</span></span><br><span class="line">	<span class="meta">@Mappings(&#123;</span></span><br><span class="line"><span class="meta">    	@Mapping(source = &quot;townName&quot;, target = &quot;regionName&quot;),</span></span><br><span class="line"><span class="meta">        @Mapping(source = &quot;bName&quot;, target = &quot;bbbName&quot;)</span></span><br><span class="line"><span class="meta">    &#125;)</span></span><br><span class="line">    AgrSceneGroupTempRel <span class="title function_">toEntity</span><span class="params">(AgrSceneGroupTempRelDTO trainingDto)</span>;</span><br><span class="line"></span><br><span class="line">    AgrSceneGroupTempRelDTO <span class="title function_">toDto</span><span class="params">(AgrSceneGroupTempRel training)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;AgrSceneGroupTempRelDTO&gt; <span class="title function_">listEntityToDto</span><span class="params">(List&lt;AgrSceneGroupTempRel&gt; training)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-3-clean，然后-compile"><a href="#2-3-clean，然后-compile" class="headerlink" title="2.3 clean，然后 compile"></a>2.3 clean，然后 compile</h2><p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/Fi_gn6GCYIva3UgPePQ1FS4byndW.png"></p>
<ul>
<li>实现类已生成</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FsiIe-PvihcBiwb6tqn-5XBBEEY9.png"></p>
<h1 id="3-注解"><a href="#3-注解" class="headerlink" title="3 注解"></a>3 注解</h1><ul>
<li>@Mapper<ul>
<li>componentModel<ul>
<li>default：默认，可以通过 Mappers.getMapper(Class) 方式获取实例对象</li>
<li>spring：在接口的实现类上自动添加注解 @Component，可通过 @Autowired 方式注入</li>
</ul>
</li>
</ul>
</li>
<li>@Mapping 属性映射，若源对象属性与目标对象名字一致，会自动映射对应属性<ul>
<li>source：源属性</li>
<li>target：目标属性</li>
<li>dateFormat：String 到 Date 日期之间相互转换</li>
<li>ignore: 转换时忽略这个字段</li>
</ul>
</li>
<li>@Mappings：配置多个@Mapping</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/09/03/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E6%A1%86%E6%9E%B6/log/Log/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/03/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E6%A1%86%E6%9E%B6/log/Log/" class="post-title-link" itemprop="url">Log</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-03 01:00:20" itemprop="dateCreated datePublished" datetime="2020-09-03T01:00:20+08:00">2020-09-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:55:33" itemprop="dateModified" datetime="2023-02-08T00:55:33+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">中间件与框架</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E6%A1%86%E6%9E%B6/log/" itemprop="url" rel="index"><span itemprop="name">log</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/Fj5tagGSzGFScHm7h8xRYQ582ixJ.jpeg"></p>
<h1 id="1-日志门面"><a href="#1-日志门面" class="headerlink" title="1 日志门面"></a>1 日志门面</h1><h2 id="1-1-Commons-Logging"><a href="#1-1-Commons-Logging" class="headerlink" title="1.1 Commons Logging"></a>1.1 Commons Logging</h2><p>Commons Logging 是通过动态查找机制，在程序运行时，使用自己的 ClassLoader 寻找和载入本地具体的实现。详细策略可以查看 commons-logging-*.jar 包中的 org.apache.commons.logging.impl.LogFactoryImpl.java 文件。由于 Osgi 不同的插件使用独立的 ClassLoader，Osgi 的这种机制保证了插件互相独立, 其机制限制了 Commons Logging 在 Osgi 中的正常使用。</p>
<h2 id="1-2-Slf4j"><a href="#1-2-Slf4j" class="headerlink" title="1.2 Slf4j"></a>1.2 Slf4j</h2><p>Slf4j 在编译期间，静态绑定本地的 Log 库，因此可以在 Osgi 中正常使用。它是通过查找类路径下 org.slf4j.impl.StaticLoggerBinder，然后在 StaticLoggerBinder 中进行绑定。</p>
<hr>
<h1 id="2-日志实现"><a href="#2-日志实现" class="headerlink" title="2 日志实现"></a>2 日志实现</h1><h2 id="2-1-Logback"><a href="#2-1-Logback" class="headerlink" title="2.1 Logback"></a>2.1 Logback</h2><h2 id="2-2-Log4j"><a href="#2-2-Log4j" class="headerlink" title="2.2 Log4j"></a>2.2 Log4j</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/09/02/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%B8%8E%E5%AE%89%E5%85%A8/HTTP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/02/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%B8%8E%E5%AE%89%E5%85%A8/HTTP/" class="post-title-link" itemprop="url">HTTP</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-02 23:08:34" itemprop="dateCreated datePublished" datetime="2020-09-02T23:08:34+08:00">2020-09-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:20:31" itemprop="dateModified" datetime="2023-02-08T00:20:31+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%B8%8E%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">计算机网络与安全</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-概述"><a href="#1-概述" class="headerlink" title="1 概述"></a>1 概述</h1><p><strong>以下部分内容摘自《图解 HTTP》</strong></p>
<ul>
<li><p><strong>无状态协议</strong></p>
<blockquote>
<p>HTTP 协议自身不对请求和响应之间的通信状态进行保存。也就是说 HTTP 这个级别，协议对于发送过的请求和响应都不做持久化的处理。</p>
</blockquote>
<ul>
<li>设计简单，为了更快的处理大量的事务，确保协议的可伸缩性</li>
<li>HTTP + Cookie 就可以管理状态了</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><p><strong>持久连接</strong></p>
<blockquote>
<p>持久连接也被称为 HTTP keep alive 或者 HTTP connection reuse。它的特点是，只要任意一端没有明确提出断开连接，则保持 TCP 连接状态。</p>
</blockquote>
<ul>
<li><p>好处</p>
<ul>
<li>减少了 TCP 连接重复建立和断开的时间开销</li>
<li>减轻了服务端的负载</li>
</ul>
</li>
<li><p><strong>HTTP 初始版本：</strong></p>
</li>
</ul>
</li>
</ul>
<p>**<br><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FgNGqwwDzAa16gEWUFAsnZDeivZY.webp"></p>
<ul>
<li><strong>HTTP1.1 后默认持久连接：</strong></li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FhmMpE_lm644NSa5wMuRrWuY2zzE.webp"></p>
<hr>
<ul>
<li>管线化<blockquote>
<p>同时<strong>并行</strong>发送多个请求。之前需要发送请求之后必须等待并且接收到回应之后，才能发送下一个请求。管线化技术出现之后，就不用等待就可以发送下一个请求了。</p>
</blockquote>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FhB7Z09Xacz__aoppbDsugTqkkUL.webp"></p>
<h1 id="2-HTTP-请求方法"><a href="#2-HTTP-请求方法" class="headerlink" title="2 HTTP 请求方法"></a>2 HTTP 请求方法</h1><h2 id="2-1-GET"><a href="#2-1-GET" class="headerlink" title="2.1 GET"></a>2.1 GET</h2><ul>
<li>一般用来获取数据</li>
<li>HTTP 协议规范没有对 URL 长度进行限制，但是特定的<strong>浏览器</strong>及<strong>服务器</strong>会对长度进行限制，如果是服务端调用服务端接口，则长度只受服务器影响<ul>
<li>IE    2083 个字符</li>
<li>Firefox    65,536 个字符</li>
<li>Safari    80,000 个字符</li>
<li>Opera    190,000 个字符</li>
<li>Google chrome    8182 个字符</li>
<li>Apache Server    8,192 个字符</li>
<li>IIS 微软 web server    16,384 个字符</li>
</ul>
</li>
</ul>
<h2 id="2-2-POST"><a href="#2-2-POST" class="headerlink" title="2.2 POST"></a>2.2 POST</h2><p>一般用来新增数据</p>
<h2 id="2-3-PUT"><a href="#2-3-PUT" class="headerlink" title="2.3 PUT"></a>2.3 PUT</h2><p>一般用来修改数据</p>
<h2 id="2-4-Delete"><a href="#2-4-Delete" class="headerlink" title="2.4 Delete"></a>2.4 Delete</h2><p>一般用来删除数据</p>
<h2 id="2-5-TRACE"><a href="#2-5-TRACE" class="headerlink" title="2.5 TRACE"></a>2.5 TRACE</h2><p>回显服务器收到的请求，主要用于测试或诊断</p>
<h2 id="2-6-OPTIONS"><a href="#2-6-OPTIONS" class="headerlink" title="2.6 OPTIONS"></a>2.6 OPTIONS</h2><p>获取服务器支持的 HTTP 请求方法<br>用来检查服务器的性能</p>
<h2 id="2-7-HEAD"><a href="#2-7-HEAD" class="headerlink" title="2.7 HEAD"></a>2.7 HEAD</h2><p>请求获取由 Request-URI 所标识的资源的响应消息报头</p>
<h2 id="2-8-CONNECT"><a href="#2-8-CONNECT" class="headerlink" title="2.8 CONNECT"></a>2.8 CONNECT</h2><p>This specification reserves the method name CONNECT for use with a proxy that can dynamically switch to being a tunnel</p>
<hr>
<h1 id="3-HTTP-状态码"><a href="#3-HTTP-状态码" class="headerlink" title="3 HTTP 状态码"></a>3 HTTP 状态码</h1><ul>
<li><strong>200</strong> OK<ul>
<li>当您的操作将在响应正文中返回数据时，出现此结果。</li>
</ul>
</li>
<li><strong>204</strong> No Content<ul>
<li>当您的操作成功，但不在响应正文中返回数据时，出现此结果。</li>
</ul>
</li>
<li><strong>304</strong> Not Modified（重定向）<ul>
<li>当测试实体自上次检索以来是否被修改时，出现此结果。</li>
</ul>
</li>
<li><strong>403</strong> Forbidden</li>
<li><strong>401</strong> Unauthorized<ul>
<li>客户端试图未经授权访问受保护的资源</li>
</ul>
</li>
<li><strong>413</strong> Payload Too Large<ul>
<li>当请求长度过长时，出现此结果。</li>
</ul>
</li>
<li><strong>400</strong> BadRequest<ul>
<li>当参数无效时，出现此结果。</li>
</ul>
</li>
<li><strong>404</strong> Not Found<ul>
<li>无法找到指定位置的资源</li>
</ul>
</li>
<li><strong>405</strong> Method Not Allowed<ul>
<li>请求方法（GET、POST、HEAD、Delete、PUT、TRACE 等）对指定的资源不适用。</li>
</ul>
</li>
<li><strong>406</strong> Not Acceptable<ul>
<li>指定的资源已经找到，但它的 MIME 类型和客户在 Accpet 头中所指定的不兼容</li>
</ul>
</li>
<li><strong>412</strong> Precondition Failed</li>
<li><strong>500</strong> Internal Server Error<ul>
<li>服务器内部错误</li>
</ul>
</li>
<li><strong>501</strong> Not Implemented<ul>
<li>当未实施某个请求的操作时，出现此结果。</li>
</ul>
</li>
<li><strong>502</strong> Bad Gateway</li>
<li><strong>503</strong> Service Unavailable<ul>
<li>当 Web API 服务不可用时，出现此结果。</li>
</ul>
</li>
<li><strong>504</strong> Gateway Timeout<ul>
<li>由代理或网关服务使用，表示不能及时地从远程服务器获得应答</li>
</ul>
</li>
</ul>
<h1 id="4-HTTP-head-中常用字段"><a href="#4-HTTP-head-中常用字段" class="headerlink" title="4 HTTP head 中常用字段"></a>4 HTTP head 中常用字段</h1><h2 id="4-1-request"><a href="#4-1-request" class="headerlink" title="4.1 request"></a>4.1 request</h2><ul>
<li>Accept：用于高速服务器，客户机支持的数据类型</li>
<li>Accept-Charset：用于告诉服务器，客户机采用的编码格式</li>
<li>Accept-Encoding：用于告诉服务器，客户机支持的数据压缩格式</li>
<li>Accept-Language：客户机的语言环境</li>
<li>Host：客户机通过这个头高速服务器，想访问的主机名</li>
<li>If-Modified-Since：客户机通过这个头告诉服务器，资源的缓存时间</li>
<li>Referer：客户机通过这个头告诉服务器，它是从哪个资源来访问服务器的（防盗链）</li>
<li><strong>Content-Type</strong>：指定 body 中的数据类型</li>
<li>Content-Length：指定发送数据的长度</li>
<li>User-Agent：客户机通过这个头告诉服务器，客户机的软件环境</li>
<li>Cookie：客户机通过这个头可以向服务器带数据</li>
<li>Connection：处理完这次请求后是否断开连接还是继续保持连接</li>
<li>Date：当前时间值</li>
</ul>
<h2 id="4-2-response"><a href="#4-2-response" class="headerlink" title="4.2 response"></a>4.2 response</h2><ul>
<li>Location：这个头配合 302 状态码使用，用于告诉客户找谁。</li>
<li>Server：服务器通过这个头告诉浏览器服务器的类型。</li>
<li>Content-Encoding：服务器通过这个头告诉浏览器数据的压缩格式。</li>
<li>Content-Length：服务器通过这个头告诉浏览器回送数据的长度</li>
<li><strong>Content-Type</strong>：服务器通过这个头告诉浏览器回送数据的类型</li>
<li>Last-Modified：告诉浏览器当前资源的最后缓存时间</li>
<li>Refresh：告诉浏览器隔多久刷新一次</li>
<li>Content-Disposition：告诉浏览器以下载方式打开数据</li>
<li>Transfer-Encoding：告诉浏览器数据的传送格式</li>
<li>ETag：缓存相关的头</li>
<li>Expires：告诉浏览器把回送的资源缓存多长时间 -1 或 0 则是不缓存</li>
<li>Cache-Control：no-cache ，控制浏览器不要缓存数据</li>
<li>Pragma：no-cache， 控制浏览器不要缓存数据</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/09/02/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E6%A1%86%E6%9E%B6/GraphQL/GraphQL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/02/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E6%A1%86%E6%9E%B6/GraphQL/GraphQL/" class="post-title-link" itemprop="url">GraphQL</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-02 12:37:45" itemprop="dateCreated datePublished" datetime="2020-09-02T12:37:45+08:00">2020-09-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:55:33" itemprop="dateModified" datetime="2023-02-08T00:55:33+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">中间件与框架</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%8E%E6%A1%86%E6%9E%B6/GraphQL/" itemprop="url" rel="index"><span itemprop="name">GraphQL</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-简介"><a href="#1-简介" class="headerlink" title="1 简介"></a>1 简介</h1><p>与 RESTful 不同，每一个的 GraphQL 服务其实对外只提供了一个用于调用内部接口的端点，所有的请求都访问这个暴露出来的唯一端点。<br><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FsGCbdjuHnVSaW7XdtRGhCwm1zfK.png"></p>
<h2 id="1-1-标量"><a href="#1-1-标量" class="headerlink" title="1.1 标量"></a>1.1 标量</h2><p>标量(ScalarTypeDefinition)是 GraphQL 中不可分割的原子数据类型，在服务中充当叶子节点。对于客户端而言，合法的查询集(Select Set)必须到达叶子节点，也就是到达标量类型节点。</p>
<ul>
<li><strong>GraphQL 规范提供了五种标量：</strong></li>
</ul>
<ol>
<li>Int: 32 位有符号整型，超出精度范围后，引擎会抛出异常</li>
<li>Float: 有符号双精度浮点数，超出精度范围后，引擎会抛出异常</li>
<li>String: 字符串，用于表示 UTF-8 字符序列</li>
<li>Boolean: bool 值</li>
<li>ID: 资源唯一标志符</li>
</ol>
<ul>
<li><strong>自定义标量：</strong></li>
</ul>
<ol>
<li>在.graphql 文件中定义标量</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scalar Datetime</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><strong>定义序列化、反序列化函数</strong></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DateTimeScalarType</span> <span class="keyword">extends</span> <span class="title class_">GraphQLScalarType</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DATE_FORMAT</span> <span class="operator">=</span> <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">SimpleDateFormat</span> <span class="variable">sdf</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DateTimeScalarType</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(<span class="string">&quot;DateTime&quot;</span>, <span class="string">&quot;A valid date time value.&quot;</span>, <span class="keyword">new</span> <span class="title class_">Coercing</span>&lt;Date, String&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> String <span class="title function_">serialize</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">                <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> (Date) o;</span><br><span class="line">                <span class="keyword">return</span> sdf.format(date);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Date <span class="title function_">parseValue</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> String.valueOf(o);</span><br><span class="line">                <span class="keyword">if</span> (<span class="string">&quot;null&quot;</span>.equalsIgnoreCase(value) || <span class="string">&quot;&quot;</span>.equalsIgnoreCase(value)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> DateUtils.parseDate(value, DATE_FORMAT);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Date <span class="title function_">parseLiteral</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> String.valueOf(o);</span><br><span class="line">                <span class="keyword">if</span> (<span class="string">&quot;null&quot;</span>.equalsIgnoreCase(value) || <span class="string">&quot;&quot;</span>.equalsIgnoreCase(value)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> DateUtils.parseDate(value, DATE_FORMAT);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="2-应用"><a href="#2-应用" class="headerlink" title="2 应用"></a>2 应用</h1><h2 id="2-1-依赖"><a href="#2-1-依赖" class="headerlink" title="2.1 依赖"></a>2.1 依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.graphql-java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>graphql-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.graphql-java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>graphql-java-tools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.graphql-java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>graphiql-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.0.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="2-2-使用"><a href="#2-2-使用" class="headerlink" title="2.2 使用"></a>2.2 使用</h2><ul>
<li>定义 root.graphqls（应与 resolver 类中方法同名）：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#查询入口</span><br><span class="line">type Query &#123;</span><br><span class="line">    selectById(id:ID!): City</span><br><span class="line">    selectAgrTemplateStyleById(id:ID!): AgrTemplateStyle</span><br><span class="line">    queryq: AgrScene</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#修改入口</span><br><span class="line">type Mutation &#123;</span><br><span class="line">    updateCityById(input: CityInput!): Int</span><br><span class="line">    releaseTemplate(agrSceneGroupTempRel:AgrSceneGroupTempRel!): Int</span><br><span class="line">    offlineTemplate(id:ID!): Int</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//定义输入类型</span><br><span class="line">input AgrSceneGroupTempRel &#123;</span><br><span class="line">    id:Int</span><br><span class="line">    templateId: Int</span><br><span class="line">    parentTemplateId: Int</span><br><span class="line">    groupId: Int</span><br><span class="line">    tenantId: Int</span><br><span class="line">    isDelete: Int</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>实现类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TemplateMutation</span> <span class="keyword">implements</span> <span class="title class_">GraphQLMutationResolver</span> &#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> ITemplateService iTemplateService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">releaseTemplate</span><span class="params">(AgrSceneGroupTempRelDTO dto)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> iTemplateService.releaseTemplate(dto);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><a target="_blank" rel="noopener" href="http://localhost:8089/graphiql">http://localhost:8089/graphiql</a>，前端参数：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">--参数为AgrSceneGroupTempRel</span><br><span class="line">mutation&#123;</span><br><span class="line">  releaseTemplate(</span><br><span class="line">    agrSceneGroupTempRel:&#123;templateId:1&#125;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">--参数为List&lt;AgrSceneGroupTempRel&gt;</span><br><span class="line">mutation&#123;</span><br><span class="line">  releaseTemplate(</span><br><span class="line">    agrSceneGroupTempRel:</span><br><span class="line">    [&#123;templateId:1&#125;,&#123;templateId:2&#125;]</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/08/31/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/MySQL-%E6%9F%A5%E8%AF%A2%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/31/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/MySQL-%E6%9F%A5%E8%AF%A2%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" class="post-title-link" itemprop="url">MySQL-查询性能优化</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-31 11:59:36" itemprop="dateCreated datePublished" datetime="2020-08-31T11:59:36+08:00">2020-08-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:34:25" itemprop="dateModified" datetime="2023-02-08T00:34:25+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>衡量查询开销的三个指标</strong></p>
<ul>
<li>响应时间（= 服务时间 + 排队时间）<ul>
<li>服务时间：数据库处理查询真正花费的时间</li>
<li>排队时间：服务器因为等待某些资源而没有真正执行查询的时间</li>
</ul>
</li>
<li>扫描的行数</li>
<li>返回的行数</li>
</ul>
<hr>
<h1 id="0-优化顺序"><a href="#0-优化顺序" class="headerlink" title="0 优化顺序"></a>0 优化顺序</h1><blockquote>
<p>以下成本由低到高</p>
</blockquote>
<h2 id="0-1-优化-sql-和-index"><a href="#0-1-优化-sql-和-index" class="headerlink" title="0.1 优化 sql 和 index"></a>0.1 优化 sql 和 index</h2><h2 id="0-2-加缓存（redis-等）"><a href="#0-2-加缓存（redis-等）" class="headerlink" title="0.2 加缓存（redis 等）"></a>0.2 加缓存（redis 等）</h2><h2 id="0-3-分区"><a href="#0-3-分区" class="headerlink" title="0.3 分区"></a>0.3 分区</h2><h2 id="0-4-分表"><a href="#0-4-分表" class="headerlink" title="0.4 分表"></a>0.4 分表</h2><h3 id="0-4-1-垂直切分"><a href="#0-4-1-垂直切分" class="headerlink" title="0.4.1 垂直切分"></a>0.4.1 垂直切分</h3><p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FmwCa_HhBBXSX_jf_UX9NaxUQHvR.png"></p>
<h3 id="0-4-2-水平切分"><a href="#0-4-2-水平切分" class="headerlink" title="0.4.2 水平切分"></a>0.4.2 水平切分</h3><p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FhAd3jNgZCpZSqc_Sa-6CEFjIaoD.png"></p>
<h2 id="0-5-分库"><a href="#0-5-分库" class="headerlink" title="0.5 分库"></a>0.5 分库</h2><p>主从复制，读写分离<br><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FlRQkiEU_uHr5nv85_2qxYRR9Go1.png"></p>
<hr>
<h1 id="1-优化数据访问"><a href="#1-优化数据访问" class="headerlink" title="1.优化数据访问"></a>1.优化数据访问</h1><h2 id="1-1-是否向服务器请求了不需要的数据"><a href="#1-1-是否向服务器请求了不需要的数据" class="headerlink" title="1.1 是否向服务器请求了不需要的数据"></a>1.1 是否向服务器请求了不需要的数据</h2><ul>
<li>查询不需要的记录</li>
<li>总是去查询全部列</li>
<li>重复查询相同数据（相同数据可缓存起来）</li>
</ul>
<h2 id="1-2MySQL-是否扫描了额外记录"><a href="#1-2MySQL-是否扫描了额外记录" class="headerlink" title="1.2MySQL 是否扫描了额外记录"></a>1.2MySQL 是否扫描了额外记录</h2><p>通过执行计划，若发现了查询需要扫描大量的数据，但值返回少数的行，通常可以尝试以下方式优化：</p>
<ul>
<li><strong>覆盖索引。</strong>把所有需要用到的列都放到索引中，这样存储引擎无需回表。</li>
<li><strong>改变库表结</strong>构。（例如使用单独的汇总表）</li>
<li><strong>重写查询。</strong>让 MySQL 优化器能够以更优化的方式执行这个查询。<ul>
<li><strong>切分查询</strong></li>
</ul>
</li>
</ul>
<p>有时候可以对一个大查询“分而治之”(若一个查询可以胜任，还切分为多个独立查询是不明智的)，将大查询切分为小查询，每个查询功能完全一样，只完成一小部分。<br>例如删除旧数据，清理大量数据时，如果一次完成，则可能需要一次锁住很多数据，耗尽系统资源，阻塞很多小而重要的查询。在每次删除部分数据后，可以暂停一会儿再做下一次删除操作，可以将压力分散到一个很长的时间段，降低对服务器的影响。</p>
<ul>
<li><strong>分解关联查询</strong></li>
</ul>
<p>很多高性能的应用都会对关联查询进行分解。对每一个表进行一次单表查询，然后在应用中对结果进行关联</p>
<pre><code>  - 缓存效率更高
  - 应用层做关联，可以更容易对数据库进行拆分。
</code></pre>
<hr>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/08/28/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/MySQL-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/28/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/MySQL-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/" class="post-title-link" itemprop="url">MySQL-存储引擎</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-28 14:15:40" itemprop="dateCreated datePublished" datetime="2020-08-28T14:15:40+08:00">2020-08-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:34:28" itemprop="dateModified" datetime="2023-02-08T00:34:28+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FhzzJGcZ1bYvjnXYV3C0Aud7QlGz.jpeg"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">--查看mysql现在已提供什么存储引擎</span><br><span class="line">show engines;</span><br><span class="line">--查看table使用的是什么引擎</span><br><span class="line">show table status like &#x27;table_name&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FoksqPjIY3skJ3Uz-9GO6KBTrtab.png"></p>
<hr>
<ul>
<li>除非需要用到某些 InnoDB 不具备的特性，并且没有其他方法可以替代，否则应优先选择 InnoDB。</li>
<li>除非万不得已，否则建议不要混合使用多种存储引擎。</li>
</ul>
<h1 id="1-InnoDB"><a href="#1-InnoDB" class="headerlink" title="1.InnoDB"></a>1.InnoDB</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/08/27/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/MySQL-%E7%B4%A2%E5%BC%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/27/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/MySQL-%E7%B4%A2%E5%BC%95/" class="post-title-link" itemprop="url">MySQL-索引</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-27 17:34:41" itemprop="dateCreated datePublished" datetime="2020-08-27T17:34:41+08:00">2020-08-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-02-08 00:34:35" itemprop="dateModified" datetime="2023-02-08T00:34:35+08:00">2023-02-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FisYeEfWKeHAVtpasfiBRu2sekhi.jpeg">- 由存储引擎负责实现索引，不同存储引擎的索引工作方式并不一样。</p>
<h1 id="1-操作"><a href="#1-操作" class="headerlink" title="1.操作"></a>1.操作</h1><h2 id="1-1-创建"><a href="#1-1-创建" class="headerlink" title="1.1 创建"></a>1.1 创建</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">--index_name可选</span><br><span class="line">ALTER TABLE table_name ADD INDEX index_name (column_names);</span><br><span class="line">ALTER TABLE table_name ADD UNIQUE (column_names);</span><br><span class="line">ALTER TABLE table_name ADD PRIMARY KEY (column_names);</span><br><span class="line"></span><br><span class="line">--不能用CREATE INDEX语句创建PRIMARY KEY索引</span><br><span class="line">CREATE INDEX index_name ON table_name (column_list);</span><br><span class="line">CREATE UNIQUE INDEX index_name ON table_name (column_list);</span><br></pre></td></tr></table></figure>

<h2 id="1-2-删除"><a href="#1-2-删除" class="headerlink" title="1.2 删除"></a>1.2 删除</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE table_name DROP INDEX index_name;</span><br><span class="line">ALTER TABLE table_name DROP PRIMARY KEY;</span><br><span class="line"></span><br><span class="line">--只在删除PRIMARY KEY索引时使用</span><br><span class="line">DROP INDEX index_name ON talbe_name;</span><br></pre></td></tr></table></figure>

<p>如果没有创建 PRIMARY KEY 索引，但表具有一个或多个 UNIQUE 索引，则 MySQL 将删除第一个 UNIQUE 索引。<br>对于多列组合的索引，如果删除其中的某列，则该列也会从索引中删除。如果删除组成索引的所有列，则整个索引将被删除。</p>
<h2 id="1-3-查看"><a href="#1-3-查看" class="headerlink" title="1.3 查看"></a>1.3 查看</h2><h3 id="1-3-1-查看索引"><a href="#1-3-1-查看索引" class="headerlink" title="1.3.1 查看索引"></a>1.3.1 查看索引</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SHOW INDEX FROM table_name;</span><br><span class="line">SHOW KEYS FROM table_name;</span><br></pre></td></tr></table></figure>

<ul>
<li>Table                  表的名称</li>
<li>Non_unique      如果索引不能包括重复词，则为 0。如果可以，则为 1。</li>
<li>Key_name         索引的名称。</li>
<li>Seq_in_index     索引中的列序列号，从 1 开始。</li>
<li>Column_name    列名称。</li>
<li>Collation             列以什么方式存储在索引中。在 MySQL 中，有值‘A’（升序）或 NULL（无分类）。</li>
<li>Cardinality         索引中唯一值的数目的估计值。通过运行 ANALYZE TABLE 或 myisamchk -a 可以更新。基数根                              据被存储为整数的统计数据来计数，所以即使对于小型表，该值也没有必要是精确的。基数                              越大，当进行联合时，MySQL 使用该索引的机会就越大。</li>
<li>Sub_part 　　      如果列只是被部分地编入索引，则为被编入索引的字符的数目。如果整列被编入索引，则为                             NULL。</li>
<li>Packed                 指示关键字如何被压缩。如果没有被压缩，则为 NULL。</li>
<li>Null     　　          如果列含有 NULL，则含有 YES。如果没有，则该列含有 NO。</li>
<li>Index_type     　用过的索引方法（BTREE, FULLTEXT, HASH, RTREE）。</li>
</ul>
<h3 id="1-3-2-查看执行计划"><a href="#1-3-2-查看执行计划" class="headerlink" title="1.3.2 查看执行计划"></a>1.3.2 查看执行计划</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">explain select column_names from table_name;</span><br><span class="line"></span><br><span class="line">explain select * from book where author_name_id = (select id from author where author_name = &#x27;District panel&#x27;);</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FkB1WS-bxkgpnhG9KggQVrCwthUU.png"></p>
<ul>
<li><p><strong>id</strong></p>
<blockquote>
<p>表示查询中执行 SELECT 子句或操作表的顺序,SQL 按 id 从大到小执行。</p>
</blockquote>
</li>
<li><p><strong>select_type</strong></p>
<blockquote>
<p>表示 select 查询的类型</p>
</blockquote>
<ul>
<li><strong>SIMPLLE</strong>：简单查询，该查询不包含 UNION 或子查询</li>
<li><strong>PRIMARY</strong>：如果查询包含 UNION 或子查询，则最外层的查询被标识为 PRIMARY</li>
<li>UNION：表示此查询是 UNION 中的第二个或者随后的查询</li>
<li>DEPENDENT：UNION 满足 UNION 中的第二个或者随后的查询，其次取决于外面的查询</li>
<li>UNION RESULT：UNION 的结果 SUBQUERY：子查询中的第一个 select 语句(该子查询不在 from 子句中)</li>
<li><strong>SUBQUERY</strong>：子查询中的第一个 select 语句(该子查询不在 from 子句中)</li>
<li>DEPENDENT SUBQUERY：子查询中的 第一个 select，同时取决于外面的查询</li>
<li><strong>DERIVED</strong>：包含在 from 子句中子查询(也称为派生表)</li>
<li>UNCACHEABLE SUBQUERY：满足是子查询中的第一个 select 语句，同时意味着 select 中的某些特性阻止结果被缓存于一个 Item_cache 中</li>
<li>UNCACHEABLE UNION：满足此查询是 UNION 中的第二个或者随后的查询，同时意味着 select 中的某些特性阻止结果被缓存于一个 Item_cache 中</li>
</ul>
</li>
<li><p><strong>table</strong></p>
<blockquote>
<p>该列显示了对应行正在访问哪个表(有别名就显示别名)。当 from 子句中有子查询时，table 列是 <derivenN>格式，表示当前查询依赖 id=N 的查询，于是先执行 id=N 的查询）</p>
</blockquote>
</li>
<li><p><strong>partitions</strong></p>
</li>
<li><p>**type</p>
<blockquote>
<p>称为<strong>关联类型</strong>或者<strong>访问类型</strong>，它指明了 MySQL 决定如何查找表中符合条件的行，同时<strong>是我们判断查询是否高效的重要依据</strong>。</p>
</blockquote>
<ul>
<li>ALL：全表扫描</li>
<li>index：全索引扫描。index 与 ALL 区别为 index 类型只遍历索引树</li>
<li>range：范围扫描</li>
<li>ref：一种索引访问，也称索引查找，它返回所有匹配某个单个值的行。针对于非唯一或非主键索引</li>
<li>eq_ref：唯一性索引或主键查找时会出现该值，非常高效。</li>
<li>const、system：该表至多有一个匹配行，在查询开始时读取，或者该表是系统表，只有一行匹配。其中 const 用于在和 primary key 或 unique 索引中有固定值比较的情形。</li>
<li>NULL：在执行阶段不需要访问表。</li>
</ul>
</li>
</ul>
<p><em>从上至下，性能越来越好。</em></p>
<ul>
<li><p><strong>possible_keys</strong><br>这一列显示查询可能使用哪些索引来查找</p>
</li>
<li><p><strong>key</strong></p>
<blockquote>
<p>显示 MySQL 在查询中实际使用的索引，若没有使用索引，显示为 NULL</p>
</blockquote>
</li>
<li><p><strong>key_len</strong></p>
</li>
<li><p><strong>ref</strong></p>
</li>
<li><p><strong>rows</strong></p>
<blockquote>
<p>这一列显示了<strong>估计</strong>要找到所需的行而要读取的行数，这个值是个估计值，原则上值越小越好。</p>
</blockquote>
</li>
<li><p><strong>filtered</strong></p>
<blockquote>
<p>表示返回结果的行数占需要读取行数的百分比，值越大越好，filtered 列的值依赖统计信息，并不十分准确</p>
</blockquote>
</li>
<li><p><strong>Extra</strong></p>
<blockquote>
<p>包含不适合在其他列中显示但十分重要的额外信息</p>
</blockquote>
<ul>
<li>Using index：使用覆盖索引，表示查询索引就可查到所需数据，不用扫描表数据文件，往往说明性能不错。</li>
<li>Using Where：在存储引擎检索行后再进行过滤，使用了 where 从句来限制哪些行将与下一张表匹配或者是返回给用户。</li>
<li>Using temporary：在查询结果排序时会使用一个临时表，一般出现于排序、分组和多表 join 的情况，查询效率不高，建议优化。</li>
<li>Using filesort：对结果使用一个外部索引排序，而不是按索引次序从表里读取行，一般有出现该值，都建议优化去掉，因为这样的查询 CPU 资源消耗大。</li>
</ul>
</li>
</ul>
<hr>
<h1 id="2-索引数据结构"><a href="#2-索引数据结构" class="headerlink" title="2.索引数据结构"></a>2.索引数据结构</h1><h2 id="2-1B-Tree"><a href="#2-1B-Tree" class="headerlink" title="2.1B+ Tree"></a>2.1B+ Tree</h2><h2 id="2-2Hash"><a href="#2-2Hash" class="headerlink" title="2.2Hash"></a>2.2Hash</h2><ul>
<li>优势<ul>
<li>hash 索引只包含<strong>hash 值</strong>和<strong>行指针</strong>，使索引结构紧凑，查询快。</li>
</ul>
</li>
<li>劣势<ul>
<li>hash 索引数据未按索引值顺序存储，无法用于排序</li>
<li>不支持部分索引列匹配查找，{A,B}上建索引，查询 A 时无法使用该索引</li>
<li>只支持等值查找，不支持范围查找</li>
<li>hash 冲突导致查询慢，维护代价高</li>
</ul>
</li>
</ul>
<hr>
<h1 id="3-索引的存储方式"><a href="#3-索引的存储方式" class="headerlink" title="3.索引的存储方式"></a>3.索引的存储方式</h1><p><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/Fo0kfhSBLR45fVcXdA9xU_CDAIvD.png"></p>
<ul>
<li>InnoDB<ul>
<li>二级索引<ul>
<li>非叶子节点<ul>
<li>保存<strong>索引</strong>信息</li>
</ul>
</li>
<li>叶子节点<ul>
<li>保存数据的<strong>主键值</strong>（若非聚集索引，需要回表查询）</li>
</ul>
</li>
</ul>
</li>
<li>聚集索引（实际数据存储在此）<ul>
<li>非叶子节点<ul>
<li>保存<strong>索引</strong>信息</li>
</ul>
</li>
<li>叶子节点<ul>
<li>保存<strong>实际数据</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>MyISAM<ul>
<li>二级索引<ul>
<li>非叶子节点<ul>
<li>保存<strong>索引</strong>信息</li>
</ul>
</li>
<li>叶子节点<ul>
<li>保存数据的<strong>物理地址</strong></li>
</ul>
</li>
</ul>
</li>
<li>实际数据按插入顺序存储在磁盘上（非树形结构）</li>
</ul>
</li>
</ul>
<h2 id="3-1-聚簇索引"><a href="#3-1-聚簇索引" class="headerlink" title="3.1 聚簇索引"></a>3.1 聚簇索引</h2><blockquote>
<p>索引的叶子节点就是对应的数据节点（MySQL 的 MyISAM 除外）</p>
</blockquote>
<p>InnoDB 将通过<strong>主键</strong>聚集数据，若未定义主键，InnoDB 会选择一个<strong>唯一的非空索引</strong>代替，若无唯一的非空索引，InnoDB 会<strong>隐式定义一个主键</strong>来作为聚簇索引。</p>
<ul>
<li>优势<ul>
<li>可以把相关数据保存在一起，只需要从磁盘读取少量的数据页就能获取全部信息，减少磁盘 I/O。</li>
<li>数据访问更快。聚簇索引把索引和数据保存在同一个树中，因此从聚簇索引中获取数据通常比非聚簇索引要快</li>
</ul>
</li>
<li>劣势<ul>
<li>更新索引代价高。<ul>
<li>InnoDB 会将每个被更新的行移动到新的位置</li>
<li>页分裂。当行的主键值要求必须将这一行数据插入到某个已满的页中时，存储引擎会将该页分裂成两个页面来容纳改行，这就是一次页分裂操作。页分裂会导致表占用更多的磁盘空间。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="3-2-二级索引（非聚集索引）"><a href="#3-2-二级索引（非聚集索引）" class="headerlink" title="3.2 二级索引（非聚集索引）"></a>3.2 二级索引（非聚集索引）</h2><blockquote>
<p>InnoDB 中二级索引的叶子节点包含了引用行的主键值（不是行指针，没有指向行的物理地址）。<br>若保存的是行指针，那么更新聚集索引后，会更新数据到新的位置，那么也要维护二级索引的叶子节点。若保存的是主键，则可以减少对二级索引的影响</p>
</blockquote>
<ul>
<li>优势<ul>
<li>当聚簇索引中出现行移动或页分列时，减少二级索引的维护工作</li>
</ul>
</li>
<li>劣势<ul>
<li>二级索引（非聚集索引）可能比想象的要大，因为在叶子节点包含了引用行的主键值。</li>
<li>若非覆盖索引，需进行回表查询。</li>
</ul>
</li>
</ul>
<h2 id="3-3-覆盖索引"><a href="#3-3-覆盖索引" class="headerlink" title="3.3 覆盖索引"></a>3.3 覆盖索引</h2><blockquote>
<p>一个索引覆盖所有需要查询的字段值,我们称之为“覆盖索引”。</p>
</blockquote>
<p>可以直接使用索引来获取列数据，而无需回表查询。</p>
<p>当发起一个索引覆盖查询时，在 Extra 列可以看到“Using index”。<br><img src="https://cdn.jsdelivr.net/gh/heheii/blog-imag/blog-images/FvzncHHxHD3gxljXyR26CXpXx25P.png"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/9/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/11/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">110</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">32</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
